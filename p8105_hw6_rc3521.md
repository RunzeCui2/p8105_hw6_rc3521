p8105_hw6_rc3521
================
Runze Cui
2022-11-30

## Problem 2

We imported the data firstly

``` r
homicide = read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv")
```

Now, we create a city_state variable (e.g. “Baltimore, MD”), and a
binary variable indicating whether the homicide is solved. Besides, we
omit cities Dallas, TX; Phoenix, AZ; Kansas City, MO; and Tulsa, AL.

``` r
homicide_df = 
  homicide %>% 
  janitor::clean_names() %>%
   mutate(
     city_state = str_c(city, state, sep = ", "),
     resolved = as.numeric(disposition == "Closed by arrest"),
     reported_date = as.Date(as.character(reported_date), format = "%Y%m%d"),
     victim_age = as.numeric(victim_age),
     victim_race = fct_relevel(victim_race, "White")
    ) %>%
  filter(city_state != c("Tulsa, AL","Dallas, TX","Phoenix, AZ","Kansas City, MO"),
         victim_race == c("White","Black")) %>%
  relocate(city_state)
```

Fit the logistic regression by `glm` function and obtain required
measures by `broom::tidy` function

``` r
baltimore_log = 
  homicide_df %>%
  filter(city_state == "Baltimore, MD") %>%
  glm(resolved ~ victim_age + victim_race + victim_sex, data = ., family = binomial())

## get estimates and confidence interval of the adjusted odds ratio

baltimore_log %>% 
  broom::tidy() %>% 
  mutate(OR = exp(estimate),
         ci_lower = quantile(OR, 0.025),
         ci_upper = quantile(OR, 0.975)) %>%
  select(term, log_OR = estimate, OR,ci_lower,ci_upper, p.value) %>%
  knitr::kable(digits = 3)
```

| term             | log_OR |    OR | ci_lower | ci_upper | p.value |
|:-----------------|-------:|------:|---------:|---------:|--------:|
| (Intercept)      |  1.421 | 4.140 |    0.391 |    3.904 |   0.000 |
| victim_age       | -0.011 | 0.989 |    0.391 |    3.904 |   0.027 |
| victim_raceBlack | -0.923 | 0.397 |    0.391 |    3.904 |   0.000 |
| victim_sexMale   | -0.940 | 0.391 |    0.391 |    3.904 |   0.000 |
